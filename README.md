# MkDocs

## Полезные ссылки:
1. [Официальная документация](https://pages.github.com/)

***
## Описание: 


**MkDocs material** - фреймворк для создания документации, работающий
в связке со статическим генератором сайтов [MkDocs](https://www.mkdocs.org/).

#### Основные функции:

- Создание документации в формате markdown.
- Кастомизация и генерация статических сайтов в формате HTML.
- Публикация сайтов на различных облачных платформах (GitHub Pages, Amazon s3 и т.д.).

#### Метаданные:

<u>**Лицензия:**</u> [MIT License](https://wiki.lanit.ru/display/DKSOIRSUDSEC/Permissive+Licenses#tab-MIT+License).    
<u>**Наличие API:**</u> отсутствует.

#### Преимущества:

- Наличие большого количества тем для сайта
- Простота кастомизации
- Возможность предосмотра при редактировании

#### Недостатки:

- Невозможность разделения доступа

***
## Установка

>**Примечание:**   
> Инструмент может быть установлен с помощью пакетного менеджера **pip** 
> в виртуальном окружении (приоритетный способ) либо с использованием **Docker** образа.  

#### Установка с помощью pip:

1. Создадим виртуальное окружение и запустим его:
```commandline
python -m vevn venv
source venv/bin/activate
venv/Scripts/activate (для Windows)
```
2. Открываем терминал и устанавливаем необходимые зависимости:
```commandline
pip install mkdocs-material
pip install mkdocs-macros-plugin
```
Первая команда автоматически установит последние версии всех необходимых зависимостей
(MkDocs, Markdown, Pygments и Python Markdown Extensions)

***
## Использование

#### Создание сайта:
Для использования инструмента, заходим в каталог, в котором будет храниться
будущий сайт и пишем команду (точка обозначает текущую директорию):
```commandline
mkdocs new . 
```
>**Примечание:**   
> После исполнения данной команды, в директории появятся два новых файла:
> 1. mkdocs.yml - файл конфигурации. В нем хранятся основные настройки будущего сайта
> (тема, стиль, цвета и т.д.)
> 2. index.md - файл формата markdown, хранящий наполнение сайта, конвертируемое
> при создании сайта в html формат.   

Для предосмотра сайта используется команда ```mkdocs serve```. Она запускает
скрипт, публикующий сайт по адресу localhost:8000:  
![mqdocs](images/img.png)  
Это позволяет одновременно работать с наполнением сайта и смотреть получившиеся изменения. Для примера,
изменим цветовое оформление и после обновления страницы увидим результат.   
![changes](images/after_changes.jpg) 

>**Примечание:**   
> Полноценное описание возможностей генератора сайта в данном документе не затрагивается. Подробные инструкции
 по внешней кастомизации наполнения представлены в официальной документации.  

[Инструкции по работе с оформлением страниц](https://squidfunk.github.io/mkdocs-material/setup/)

## Публикация сайта:

### GitHub Pages
1. В директории проекта, создаем директорию ```.github```, в ней директорию
```workflows```. В данной директории будет лежать файл ```ci.yml``` - конфигурационный файл,
необходимый для автоматизации публикации сайта.
2. Добавить в качестве наполнения скрипт для публикации [ci.yml](images/ci.yml)   
3. Заходим на аккаунт GitHub, создаем новый репозиторий.
4. Отправляем созданный проект сайта на удаленный репозиторий:
```commandline
git init
git add .
git commit -m "message"
git remote add origin "repo_link"
git push origin "branch name"
```
>**Примечание:**   
> Опционально можно создать .gitignore для ограничения отправки ненужных файлов в репозиторий.
5. После отправки файлов на GitHub заходим в Настройки - раздел "Pages". В этом разделе выбираем ветку, в
которую запушили изменения и нажимаем "Save".
6. Выходим из настроек, заходим во вкладку "Actions" и видим наш пайплайн, который автоматически выгрузит
и опубликает сайт на GitHub Pages. Ссылка на страницу доступна в том же разделе.   
[page_deploy](images/page_deploy.jpg)

### GitLab Pages
1. В директории проекта, создаем конфигурационный файл c названием **.gitlab-ci.yml**
2. Вставляем в данный файл следующее содержимое и сохраняем файл.
```commandline
stages:
  - deploy

# Pages
pages: 
  stage: deploy
  image: javanile/mkdocs
  script: mkdocs build
  artifacts:
    paths:
      - public # public deploy
  needs: []
  only:
    - branch_name  # В данный параметр необходимо вписать 
     название ветки с размещаемым сайтом
```
3. Отправляем созданный проект сайта на удаленный репозиторий:
```commandline
git init
git add .
git commit -m "message"
git remote add origin "repo_link"
git push origin "branch name"
```
4. В GitLab заходим в раздел Deploy - Pages. После успешной отработки написанного пайплайна в разделе будет выделена ссылка  
на опубликованную страницу.


### Анализ применимости инструмента
- **CI/CD:** возможна интеграция с GitHub Actions и GitLab CI для автоматизации публикации страниц с документацией.
- **Интеграции:** Возможна интеграция плагинов MkDocs material для более комфортной генерации сайтов.
- **Командная строка/pipeline:** пример встраивания в пайплайн представлен в инструкции по публикации сайта.

***
## Особенности, выявленные при исследовании:

### Ограничения
- Для работы с инструментом необходимо досконально погружаться в документацию, понимать принципы работы со стилями и HTML.
- Большинство плагинов для MkDocs-material требуют спонсорской подписки.
- Сайты на GitHub Pages статичны, на них нельзя прикрутить ролевой доступ или формы авторизации.
- Создание сайта с помощью markdown достаточно удобно, но требует большого количества времени.

### Применимость на проектах Ланит

MkDocs-material может быть применим на проектах для создания и публикации внутренней вики проекта
(техническая документация и т.д.), а также продуктовой и пользовательской документации.

### Политики

Отсутствуют